# Lab 01 — Standalone: iRedMail complete mail server
# Self-contained — iRedMail with MariaDB. All mail services in one container.
# Webmail: http://localhost:9080/mail  Admin: postmaster@lab.local / Lab01Password!
# SMTP: localhost:9025  IMAP: localhost:9143  Submission: localhost:9587
---
services:
  iredmail:
    image: iredmail/iredmail:stable
    container_name: it-stack-iredmail-standalone
    restart: unless-stopped
    hostname: mail.lab.local
    ports:
      - "9080:80"
      - "9443:443"
      - "9025:25"
      - "9587:587"
      - "9143:143"
      - "9993:993"
    environment:
      FIRST_MAIL_DOMAIN: lab.local
      FIRST_MAIL_DOMAIN_ADMIN_PASSWORD: Lab01Password!
      HOSTNAME: mail.lab.local
    volumes:
      - iredmail-data:/var/vmail
      - iredmail-mysql-data:/var/lib/mysql
      - iredmail-log:/var/log
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost/mail || exit 1"]
      interval: 30s
      timeout: 15s
      retries: 12
      start_period: 120s
    networks:
      - iredmail-standalone-net
    deploy:
      resources:
        limits:
          memory: 1g

networks:
  iredmail-standalone-net:
    driver: bridge

volumes:
  iredmail-data:
  iredmail-mysql-data:
  iredmail-log:
